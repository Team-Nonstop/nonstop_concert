# Concert client tuples are of the platform-system-robot-name-app where
# the name is just a placemarker for the eventual concert client name.
# All other parts of the tuple are fixed.

name: "Nonstop Concert"
nodes:
  - id: softbot
    tuple: linux.ros.pc.nonstop_concert/nav_demo
    min: 0
    max: 4
    force_name_matching: true
#  - id: robot
#    tuple: linux.ros.turtlebot.nonstop_concert/turtlebot_nav_demo
  - id: raison 
    tuple: linux.ros.turtlebot.nonstop_concert/turtlebot_nav_demo
  - id: samsung 
    tuple: linux.ros.turtlebot.nonstop_concert/turtlebot_nav_demo
  - id: multinav_database
    tuple: linux.ros.*.nonstop_concert/map_sharing
topics:

# Shared Database
  - id: shared_database_map
    type: nav_msgs/OccupancyGrid
  - id: shared_database_map_metadata
    type: nav_msgs/MapMetaData


# Softbot
  - id: softbot_pose
    type: geometry_msgs/PoseStamped
  - id: softbot_map
    type: nav_msgs/OccupancyGrid
  - id: softbot_map_metadata
    type: nav_msgs/MapMetaData
  - id: softbot_simple_goal
    type: geometry_msgs/PoseStamped
  - id: softbot_initialpose
    type: geometry_msgs/PoseStamped

# Turblebot-RAISON
  - id: raison_pose
    type: geometry_msgs/PoseStamped
  - id: raison_map
    type: nav_msgs/OccupancyGrid
  - id: raison_map_metadata
    type: nav_msgs/MapMetaData
  - id: raison_simple_goal
    type: geometry_msgs/PoseStamped
  - id: raison_initialpose
    type: geometry_msgs/PoseStamped

# Turtlebot-SAMSUNG
  - id: samsung_pose
    type: geometry_msgs/PoseStamped
  - id: samsung_map
    type: nav_msgs/OccupancyGrid
  - id: samsung_map_metadata
    type: nav_msgs/MapMetaData
  - id: samsung_simple_goal
    type: geometry_msgs/PoseStamped
  - id: samsung_initialpose
    type: geometry_msgs/PoseStamped

actions:
  - id: softbot_movebase
    type: move_base_msgs/MoveBase
  - id: raison_movebase
    type: move_base_msgs/MoveBase
  - if: samsung_movebase
    type: move_base_msgs/MoveBase


edges:

## multinav database
  - start: multinav_database
    finish: multinav_database_map 
    remap_from: map
    remap_to: /map
  - start: multinav_database
    finish: multinav_database_map_metadata
    remap_from: map_metadata
    remap_to: /map_metadata

  - start: softbot
    finish: softbot_map
    remap_from: map
    remap_to: /map
  - start: softbot
    finish: softbot_map_metadata
    remap_from: map_metadata
    remap_to: /map_metadata
  - start: softbot
    finish: softbot_simple_goal
    remap_from: move_base_simple/goal
    remap_to: goal_simple
  - start: softbot
    finish: softbot_initialpose
    remap_from: initialpose
    remap_to: /softbot/initialpose

  - start: raison
    finish: raison_map
    remap_from: map
    remap_to: /map
  - start: raison
    finish: raison_map_metadata
    remap_from: map_metadata
    remap_to: /map_metadata
  - start: raison
    finish: raison_simple_goal
    remap_from: move_base_simple/goal
    remap_to: goal_simple
  - start: raison
    finish: raison_initialpose
    remap_from: initialpose
    remap_to: /raison/initialpose

  - start: samsung
    finish: samsung_map
    remap_from: map
    remap_to: /map
  - start: samsung
    finish: samsung_map_metadata
    remap_from: map_metadata
    remap_to: /map_metadata
  - start: samsung
    finish: samsung_simple_goal
    remap_from: move_base_simple/goal
    remap_to: goal_simple
  - start: samsung
    finish: samsung_initialpose
    remap_from: initialpose
    remap_to: /samsung/initialpose

