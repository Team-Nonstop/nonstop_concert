# Concert client tuples are of the platform-system-robot-name-app where
# the name is just a placemarker for the eventual concert client name.
# All other parts of the tuple are fixed.

name: "Nonstop Concert"
nodes:
  - id: sniper 
    tuple: linux.ros.sniperbot.nonstop_rapps/sniperbot
    min: 0
    max: 3

  - id: stroller 
    tuple: linux.ros.turtlebot_nonstop.turtlebot_nonstop_rapps/turtlebot_nonstop
    min: 0
    max: 2

  - id: softstroller 
    tuple: linux.ros.turtlebot_nonstop_soft.turtlebot_nonstop_soft_rapps/turtlebot_nonstop_soft
    min: 0
    max: 2

  - id: watcher
    tuple: linux.ros.coldeyes.coldeyes_rapps/coldeyes
    min: 1
    max: 1
    force_name_matching: true

  - id: supervisor
    tuple: linux.ros.markerserver.nonstop_rapps/marker_localization
    min: 1
    max: 1
    force_name_matching: true

  - id: shared_database
    tuple: linux.ros.pc.nonstop_rapps/map_sharing
    min: 1
    max: 1
#    force_name_matching: true


topics:
# Shared Database
  - id: shared_database_map
    type: nav_msgs/OccupancyGrid
  - id: shared_database_map_metadata
    type: nav_msgs/MapMetaData

# watcher
  - id: watcher_pose
    type: geometry_msgs/PoseStamped
  - id: watcher_map
    type: nav_msgs/OccupancyGrid
  - id: watcher_map_metadata
    type: nav_msgs/MapMetaData
  - id: watcher_visualization_marker
    type: visualization_msgs/Marker

# supervisor
  - id: supervisor_pose
    type: geometry_msgs/PoseStamped
  - id: supervisor_map
    type: nav_msgs/OccupancyGrid
  - id: supervisor_map_metadata
    type: nav_msgs/MapMetaData
  - id: supervisor_visualization_marker
    type: visualization_msgs/Marker
  - id: supervisor_estimate_pose
    type: geometry_msgs/PoseWithCovarianceStamped

# stroller
  - id: stroller_pose
    type: geometry_msgs/PoseStamped
  - id: stroller_map
    type: nav_msgs/OccupancyGrid
  - id: stroller_map_metadata
    type: nav_msgs/MapMetaData
  - id: stroller_simple_goal
    type: geometry_msgs/PoseStamped
  - id: stroller_initialpose
    type: geometry_msgs/PoseStamped
  - id: stroller_particlecloud
    type: geometry_msgs/PoseArray
  - id: stroller_amcl_pose
    type: geometry_msgs/PoseWithCovarianceStamped

# softstroller
  - id: softstroller_pose
    type: geometry_msgs/PoseStamped
  - id: softstroller_map
    type: nav_msgs/OccupancyGrid
  - id: softstroller_map_metadata
    type: nav_msgs/MapMetaData
  - id: softstroller_simple_goal
    type: geometry_msgs/PoseStamped
  - id: softstroller_initialpose
    type: geometry_msgs/PoseStamped
  - id: softstroller_particlecloud
    type: geometry_msgs/PoseArray

# sniper
  - id: sniper_pose
    type: geometry_msgs/PoseStamped
  - id: sniper_map
    type: nav_msgs/OccupancyGrid
  - id: sniper_map_metadata
    type: nav_msgs/MapMetaData
  - id: sniper_simple_goal
    type: geometry_msgs/PoseStamped
  - id: sniper_initialpose
    type: geometry_msgs/PoseStamped

actions:
  - id: stroller_movebase
    type: move_base_msgs/MoveBase
  - id: sniper_movebase
    type: move_base_msgs/MoveBase

edges:

## multinav database
  - start: shared_database
    finish: shared_database_map 
    remap_from: map
    remap_to: /map
  - start: shared_database
    finish: shared_database_map_metadata
    remap_from: map_metadata
    remap_to: /map_metadata

  - start: watcher
    finish: watcher_map
    remap_from: map
    remap_to: /map
  - start: watcher
    finish: watcher_map_metadata
    remap_from: map_metadata
    remap_to: /map_metadata
  - start: watcher
    finish: watcher_visualization_marker
    remap_from: visualization_marker
    remap_to: visualization_marker
  - start: watcher
    finish: watcher_front
    remap_from: front/image_raw
    remap_to: front/image_raw


  - start: supervisor
    finish: supervisor_map
    remap_from: map
    remap_to: /map
  - start: supervisor
    finish: supervisor_map_metadata
    remap_from: map_metadata
    remap_to: /map_metadata
  - start: supervisor
    finish: supervisor_estimate_pose
    remap_from: estimate_pose
    remap_to: supervisor_estimate_pose
  - start: supervisor
    finish: supervisor_front
    remap_from: front/image_raw
    remap_to: front/image_raw



  - start: stroller
    finish: stroller_map
    remap_from: map
    remap_to: /map
  - start: stroller
    finish: stroller_map_metadata
    remap_from: map_metadata
    remap_to: /map_metadata
  - start: stroller
    finish: stroller_simple_goal
    remap_from: move_base_simple/goal
    remap_to: goal_simple
  - start: stroller
    finish: stroller_initialpose
    remap_from: initialpose
    remap_to: initialpose



  - start: sniper
    finish: sniper_map
    remap_from: map
    remap_to: /map
  - start: sniper
    finish: sniper_map_metadata
    remap_from: map_metadata
    remap_to: /map_metadata
  - start: sniper
    finish: sniper_simple_goal
    remap_from: move_base_simple/goal
    remap_to: goal_simple
  - start: sniper
    finish: sniper_initialpose
    remap_from: initialpose
    remap_to: initialpose
